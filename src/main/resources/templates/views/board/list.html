<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>게시판</title>
</head>
<body>

	<div>
		<h2>게시판 목록</h2>
		<table>
			<!-- 조회 조건 추가 s-->
		
			<tr>
				<th>제목</th>
				<td><input type="text" id="title"></td>
			</tr>
			<tr>
				<th>작성자</th>
				<td><input type="text" id="writer"></td>
			</tr>
		
			<!-- 조회 조건 추가 e-->
			<tr>
				<td><button onclick="getList()">조회</button></td>
				<!-- reset btn 추가-->
				<td><button onclick="resetList()">초기화</button></td>
			</tr>
		</table>
	</div>
	<div>
		<table>
			<colgroup>
				<col width="150px" />
				<col width="150px" />
				<col width="250px" />
			</colgroup>
			<thead>
				<tr>
					<th>제목</th>
					<th>작성자</th>
					<th>작성시간</th>
				</tr>
			</thead>
			<tbody id="fieldListBody"></tbody>
		</table>
	</div>
	
	<script type="text/javascript" src="/js/com-ajax.js"></script>
	<script type="text/javascript">
	
		//페이지 온로드시 게시글 목록 조회
		window.onload = function(){
			
			getList();
		}
	
	
		//게시글 목록 조회
		function getList(){
			
			//조회 조건 파라미터 추가
			const title = document.querySelector("#title").value;
			const writer = document.querySelector("#writer").value;
			
			//AJAX.ajaxCall("GET", "/boards", "", afterGetList);
			
			AJAX.ajaxCall("GET", "/boards", "?title=" + title + "?writer=" +writer, afterGetList);
		}
		
		//조회 후 처리
		function afterGetList(response){
			resultTable(response);
		}
		
		
		//동적으로 테이블 생성
		function resultTable(response){
			
			//document.querySelector("#fieldListBody").innerHTML = "";
			
			document.getElementById("fieldListBody").innerHTML = "";
			
			if(response.length > 0){
				
				response.forEach(function(result, index){
					
					//let element = document.querySelector("#fieldListBody");
					let element = document.getElementById("fieldListBody");
					
					let template = `
					
						<td><p>${result.title}</p></td>
						<td><p>${result.writer}</p></td>
						<td><p>${result.regDate}</p></td>
					`;
					
					element.insertAdjacentHTML('beforeend', template);
					});
				
				}
			}
		
		//초기화 기능 추가
		function resetList(){
			document.querySelector("#title").value = "";
			document.querySelector("#writer").value = "";
			document.querySelector("#fieldListBody").innerHTML = "";
			
			getList();
		}
		
	</script>
</body>
</html>